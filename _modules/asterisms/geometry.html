<!doctype html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <title>asterisms.geometry</title>
    <link rel="stylesheet" type="text/css" href="_static/style.css" />
</head>
<body>
    
    <p>
        <a href="."><h3>Home</h3></a>
    </p>
    
    <h1>Source code for asterisms.geometry</h1><div class="highlight"><pre>
<span class="kn">import</span> <span class="nn">skyfield</span>
<span class="kn">from</span> <span class="nn">skyfield.units</span> <span class="kn">import</span> <span class="n">Angle</span><span class="p">,</span> <span class="n">Distance</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span>

<div class="viewcode-block" id="midpoint"><a class="viewcode-back" href="../../api.html#asterisms.geometry.midpoint">[docs]</a><span class="k">def</span> <span class="nf">midpoint</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;The midpoint between two celestial coordinates.</span>

<span class="sd">    Given a point as a tuple of either ``(Ra, Dec)`` or ``(Ra, Dec, Dist)``.</span>
<span class="sd">    RA is of Skyfield type Angle, with ``preference=&#39;hours&#39;``. Dec is of Skyfield</span>
<span class="sd">    type Angle. Distance is Skyfield type Distance, in AU units.</span>

<span class="sd">    If dist is included, the returned tuple is (Mid_RA, Mid_Dec, Mid_Dist).</span>
<span class="sd">    Otherwise, it is (Mid_RA, Mid_Dec).</span>

<span class="sd">    You can alternatively use ``center`` for multiple points.&#39;&#39;&#39;</span>

    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Can only pass two tuples to this function.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="n">mean_ra</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">radians</span> <span class="o">+</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">radians</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
    <span class="n">mean_dec</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">radians</span> <span class="o">+</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">radians</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
        <span class="n">mean_dist</span> <span class="o">=</span> <span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">AU</span> <span class="o">+</span> <span class="n">p2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">AU</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Angle</span><span class="p">(</span><span class="n">radians</span><span class="o">=</span><span class="n">mean_ra</span><span class="p">,</span> <span class="n">preference</span><span class="o">=</span><span class="s">&#39;hours&#39;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="n">radians</span><span class="o">=</span><span class="n">mean_dec</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="n">AU</span><span class="o">=</span><span class="n">mean_dist</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Angle</span><span class="p">(</span><span class="n">radians</span><span class="o">=</span><span class="n">mean_ra</span><span class="p">,</span> <span class="n">preference</span><span class="o">=</span><span class="s">&#39;hours&#39;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="n">radians</span><span class="o">=</span><span class="n">mean_dec</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="center"><a class="viewcode-back" href="../../api.html#asterisms.geometry.center">[docs]</a><span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="n">positions</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculate the visual center of a list of coordinates.</span>

<span class="sd">    This function can take two kinds of lists of positions. Lists of tuples, or</span>
<span class="sd">    lists of Stars.</span>

<span class="sd">    This may be useful for automatically centering a telescope or for a program</span>
<span class="sd">    that automatically zooms to a location.</span>

<span class="sd">    The first is a list of coordinates in tuples. It looks like ``[(ra0,dec0), (ra1,dec1)]``,</span>
<span class="sd">    where RA and Dec are Skyfield Angle instances.</span>

<span class="sd">    ::</span>

<span class="sd">        import skyfield</span>
<span class="sd">        from skyfield.api import Star, earth, now</span>
<span class="sd">        from skyfield.units import Angle, Distance</span>
<span class="sd">        from numpy import array</span>

<span class="sd">        algol = Star(ra_hours=( 3,  8, 10.1315),  dec_degrees=(40, 57, 20.332))  #approximately Algol</span>
<span class="sd">        mizar = Star(ra_hours=(13, 23, 55.5),     dec_degrees=(54, 55, 31))      #approximately Mizar</span>
<span class="sd">        vega  = Star(ra_hours=(18, 36, 56.33635), dec_degrees=(38, 47, 01.2802)) #approximately Vega</span>
<span class="sd">        stars = [algol, mizar, vega]</span>
<span class="sd">        positions = []</span>
<span class="sd">        for star in stars:</span>
<span class="sd">            star_pos = earth(now()).observe(star)</span>
<span class="sd">            positions.append(star_pos.radec())</span>

<span class="sd">        center1 = a.center(positions)</span>

<span class="sd">    Additionally, you can pass it a list of Stars. For example with Alcor, Mizar and Dubhe.</span>

<span class="sd">    ::</span>

<span class="sd">        from skyfield.data import hipparcos</span>
<span class="sd">        stars = []</span>
<span class="sd">        stars.append(hipparcos.get(&#39;65477&#39;))</span>
<span class="sd">        stars.append(hipparcos.get(&#39;65378&#39;))</span>
<span class="sd">        stars.append(hipparcos.get(&#39;54061&#39;))</span>
<span class="sd">        center3 = center(stars)</span>

<span class="sd">    RA is of Skyfield type Angle, with ``preference=&#39;hours&#39;``. Dec is of Skyfield</span>
<span class="sd">    type Angle.</span>

<span class="sd">    Returns a coordinate tuple of right ascension and declination ``(ra,dec)``.&#39;&#39;&#39;</span>

    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Must be passed a list.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="c"># Average the coordinates to get an unweighted center</span>
    <span class="n">mean_ra</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">radians</span>
    <span class="n">mean_dec</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">radians</span>
    <span class="c"># Passed list of Stars</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">positions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">skyfield</span><span class="o">.</span><span class="n">starlib</span><span class="o">.</span><span class="n">Star</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">star</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
            <span class="n">mean_ra</span> <span class="o">=</span> <span class="n">mean_ra</span> <span class="o">+</span> <span class="n">star</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">radians</span>
            <span class="n">mean_dec</span> <span class="o">=</span> <span class="n">mean_dec</span> <span class="o">+</span> <span class="n">star</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">radians</span>
    <span class="c"># Or passed list of position tuples</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
            <span class="n">mean_ra</span> <span class="o">=</span> <span class="n">mean_ra</span> <span class="o">+</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">radians</span>
            <span class="n">mean_dec</span> <span class="o">=</span> <span class="n">mean_dec</span> <span class="o">+</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">radians</span>
    <span class="n">mean_ra</span> <span class="o">=</span> <span class="n">mean_ra</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
    <span class="n">mean_dec</span> <span class="o">=</span> <span class="n">mean_dec</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>

    <span class="n">ctr</span> <span class="o">=</span> <span class="p">(</span><span class="n">Angle</span><span class="p">(</span><span class="n">radians</span><span class="o">=</span><span class="n">mean_ra</span><span class="p">,</span> <span class="n">preference</span><span class="o">=</span><span class="s">&#39;hours&#39;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="n">radians</span><span class="o">=</span><span class="n">mean_dec</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">ctr</span>
</div>
<div class="viewcode-block" id="minidisk"><a class="viewcode-back" href="../../api.html#asterisms.geometry.minidisk">[docs]</a><span class="k">def</span> <span class="nf">minidisk</span><span class="p">(</span><span class="n">P</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculate smallest enclosing disk. This computes the smallest enclosing disk of a set of n points in the plane in expected O(n) time.</span>

<span class="sd">    Given a set P of n points.</span>

<span class="sd">    Returns the closed disk of smallest radius containning all points in P. The values returned are a tuple of center, and the radius.</span>

<span class="sd">    The algorithm used is based on Emo Welzl&#39;s paper [#]_ which solves this problem in O(n) time. See `smallest-circle problem &lt;https://en.wikipedia.org/wiki/Smallest-circle_problem&gt;`_.</span>

<span class="sd">    .. [#]  Welzl, Emo (1991), &quot;`Smallest enclosing disks (balls and ellipsoids) &lt;http://dx.doi.org/10.1007%2FBFb0038202&gt;`_&quot;, in Maurer, H., New Results and New Trends in Computer Science, Lecture Notes in Computer Science 555, Springer-Verlag, pp. 359-370&#39;&#39;&#39;</span>

    <span class="k">if</span><span class="p">(</span><span class="n">P</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">P</span> <span class="ow">is</span> <span class="p">[]):</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">minidisk</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">minidisk</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>

        <span class="k">if</span><span class="p">(</span><span class="n">D</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="n">p</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">D</span><span class="p">):</span> <span class="c">#if D is defined and p is not an element of D</span>
            <span class="n">D</span> <span class="o">=</span> <span class="n">minidisk</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">D</span>
</div>
<div class="viewcode-block" id="circumcenter"><a class="viewcode-back" href="../../api.html#asterisms.geometry.circumcenter">[docs]</a><span class="k">def</span> <span class="nf">circumcenter</span><span class="p">(</span><span class="n">positions</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculate the circumcenter of a list of coordinates.</span>

<span class="sd">    Given a list of position tuples, ``[(ra0, dec0), (ra1, dec1)]`` or a list of Stars.</span>

<span class="sd">    Returns a position tuple of right ascension and declination ``(ra,dec)``.</span>

<span class="sd">    This may be useful for automatically centering a telescope or for a program that automatically zooms to a location.</span>

<span class="sd">    The algorithm used is based on Emo Welzl&#39;s paper [#]_ which solves this problem in O(n) time. See `smallest-circle problem &lt;https://en.wikipedia.org/wiki/Smallest-circle_problem&gt;`_.</span>

<span class="sd">    .. [#]  Welzl, Emo (1991), &quot;`Smallest enclosing disks (balls and ellipsoids) &lt;http://dx.doi.org/10.1007%2FBFb0038202&gt;`_&quot;, in Maurer, H., New Results and New Trends in Computer Science, Lecture Notes in Computer Science 555, Springer-Verlag, pp. 359-370&#39;&#39;&#39;</span>

    <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Must be passed a list of Stars or a list of position tuples.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">positions</span>
    <span class="n">minidisk</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="n">cc_ra</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">radians</span>
    <span class="n">cc_dec</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">radians</span>

    <span class="k">return</span> <span class="n">cc_ra</span><span class="p">,</span> <span class="n">cc_dec</span></div>
</pre></div>
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-44642246-12', 'auto');
    ga('send', 'pageview');

    </script>
</body>
</html>